<div class="max-w-3xl mx-auto">
  <h1 class="text-2xl font-semibold mb-6 text-stone-800 tracking-tight">Refinance Calculator</h1>

  <%= form_with url: "/calculator", method: :post, data: { controller: "calculator", turbo: false } do |form| %>
    <div class="grid md:grid-cols-2 gap-6 mb-6">
      <%# Current Mortgage Column %>
      <div class="bg-white p-5 rounded-xl border border-stone-200 shadow-sm">
        <h2 class="text-base font-semibold mb-4 text-stone-600 border-b border-stone-100 pb-2">Current Mortgage</h2>

        <div class="space-y-4">
          <div>
            <%= form.label :current_balance, "Remaining Balance", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">$</span>
              <%= form.number_field :current_balance, class: "border border-stone-300 rounded-lg pl-7 pr-3 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", step: 0.001, min: 0 %>
            </div>
          </div>

          <div>
            <%= form.label :current_rate, "Interest Rate", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <%= form.number_field :current_rate, class: "border border-stone-300 rounded-lg pl-3 pr-7 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", step: 0.001, min: 0, max: 30 %>
              <span class="absolute right-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">%</span>
            </div>
          </div>

          <div>
            <%= form.label :years_remaining, "Years Remaining", class: "block text-sm text-stone-500 mb-1" %>
            <%= form.number_field :years_remaining, class: "border border-stone-300 rounded-lg px-3 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", min: 1, data: { action: "input->calculator#updateTermDisplay" } %>
          </div>

          <div>
            <%= form.label :current_payment, "Monthly P&I", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">$</span>
              <%= form.number_field :current_payment, class: "border border-stone-300 rounded-lg pl-7 pr-3 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", step: 0.01, min: 0 %>
            </div>
            <p class="text-xs text-stone-400 mt-1">Exclude escrow, taxes, PMI</p>
          </div>
        </div>
      </div>

      <%# New Loan Column %>
      <div class="bg-white p-5 rounded-xl border border-stone-200 shadow-sm">
        <h2 class="text-base font-semibold mb-4 text-emerald-700 border-b border-emerald-100 pb-2">New Loan</h2>

        <div class="space-y-4">
          <div>
            <%= form.label :new_rate, "Interest Rate", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <%= form.number_field :new_rate, class: "border border-stone-300 rounded-lg pl-3 pr-7 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", step: 0.001, min: 0, max: 30 %>
              <span class="absolute right-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">%</span>
            </div>
          </div>

          <div>
            <%= form.label :same_term, class: "inline-flex items-center cursor-pointer text-sm" do %>
              <%= form.check_box :same_term, class: "mr-2 accent-emerald-600", data: { action: "change->calculator#toggleTerm" } %>
              <span class="text-stone-600">Keep same term (<span data-calculator-target="termDisplay" class="font-medium">--</span> years)</span>
            <% end %>
          </div>

          <div data-calculator-target="newTermField">
            <%= form.label :new_term, "New Loan Term", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <%= form.number_field :new_term, class: "border border-stone-300 rounded-lg pl-3 pr-12 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", min: 1, max: 40, placeholder: "e.g. 30" %>
              <span class="absolute right-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">years</span>
            </div>
          </div>

          <div>
            <%= form.label :knows_closing_costs, class: "inline-flex items-center cursor-pointer text-sm" do %>
              <%= form.check_box :knows_closing_costs, class: "mr-2 accent-emerald-600", data: { action: "change->calculator#toggleClosingCosts"} %>
              <span class="text-stone-600">Estimate closing costs for me</span>
            <% end %>
            <p class="text-xs text-stone-400 mt-1">We'll use 2-5% of loan amount</p>
          </div>

          <div data-calculator-target="closingCostsField">
            <%= form.label :closing_costs, "Closing Costs", class: "block text-sm text-stone-500 mb-1" %>
            <div class="relative">
              <span class="absolute left-3 top-1/2 -translate-y-1/2 text-stone-400 text-sm">$</span>
              <%= form.number_field :closing_costs, class: "border border-stone-300 rounded-lg pl-7 pr-3 py-2 w-full text-sm focus:border-emerald-600 focus:ring-1 focus:ring-emerald-600 outline-none bg-stone-50/50", step: 0.01, min: 0 %>
            </div>
          </div>
        </div>
      </div>
    </div>

    <%= form.submit "Calculate", class: "w-full bg-emerald-700 text-white py-3 rounded-xl font-semibold hover:bg-emerald-800 cursor-pointer transition-colors shadow-sm" %>
  <% end %>
</div>
